<!DOCTYPE HTML>
<html>

<head>

<script src="../jquery-2.1.0.min.js"></script>
<script src="cutout.js"></script>
<script src="layoutCutoutUtil.js"></script>
<script src="DirectionMap.js"></script>
<script src="acGreyImage.js"></script>
<script src="distTrans.js"></script>
<script src="Vectorize.js"></script>
<script src="Path.js"></script>

<link rel="stylesheet" href="pathImage.css">
    
<script>

var buildToolpaths3 = function(toolpaths, incanvas, debugcanvas, pathcanvas){

    var inCanvasImage = new AcGrey8Image(incanvas.width,incanvas.height);
    inCanvasImage.initFromCanvas(incanvas); // todo, decide about js ctors

    var dt = new AcGrey16Image(incanvas.width, incanvas.height);

    computeDistTrans(inCanvasImage, dt);
//   dt.debugPrint();
//   dt.draw(debugcanvas);

    var ctx = pathcanvas.getContext('2d');
    ctx.clearRect(0, 0, pathcanvas.width, pathcanvas.height);
    
    var path = new Path();
    vectorizeDistanceTrf(dt, 1, path);

    var path2 = new Path();
    vectorizeDistanceTrf(dt, 100, path2);
    
    var path3 = new Path();
    vectorizeDistanceTrf(dt, 400, path3);
    
    var path4 = new Path();
    vectorizeDistanceTrf(dt, 900, path4);
    
    path.draw(pathcanvas);
    path2.draw(pathcanvas);
    path3.draw(pathcanvas);
    path4.draw(pathcanvas);

}


var buildToolpaths2 = function(toolpaths, incanvas, canvas){

    var inCanvasImage = new AcGrey8Image(0,0);
    inCanvasImage.initFromCanvas(incanvas); // todo, decide about js ctors
    
    inCanvasImage.draw(canvas);
}
</script>
    
    
<script>

$(document).ready(function() {
    $(".boxDim").change(function() {
                
        var boxDims = {};
        boxDims.height = $("#heightbox").val()-0;
        boxDims.length = $("#lengthbox").val()-0;
        boxDims.width = $("#widthbox").val()-0;    
        boxDims.matThick = $("#matthkbox").val()-0;
        
        var fingerLength = $("#fingerLength").val()-0;
        var fingerSpacing = $("#fingerSpacing").val()-0;
        var toolbitDiam = $("#toolbitDiam").val()-0;
                        
        var cutouts = {};
        buildCutouts(cutouts, boxDims, fingerLength, fingerSpacing, toolbitDiam);

        var layout = {};
        buildLayout(layout, boxDims, toolbitDiam);
        
        var canvas = document.getElementById('mycanvas');
        drawCutouts(canvas, cutouts, layout);
        
        var toolpaths = {}; // todo temp - 

        //var outcanvas = document.getElementById('outcanvas');
        var pathcanvas = document.getElementById('pathcanvas');
        	
        buildToolpaths3(toolpaths, canvas, null, pathcanvas);      

    });
});    
</script>
</head>

<body>
<div id="header" >
<h1>&nbsp;Box Maker</h1>
</div>

<div id="Inputs" >
<table>
<tr>
  <td>Height</td>
  <td><input class="boxDim" id="heightbox" type="number" value="50" ></td>
</tr>
<tr>
  <td>Length</td>
  <td><input class="boxDim" id="lengthbox" type="number" value="100" ></td>
</tr>
<tr>
  <td>Width</td>
  <td><input class="boxDim" id="widthbox" type="number" value="50" ></td>
</tr>
<tr>
  <td>Material Thickness</td>
  <td><input class="boxDim" id="matthkbox" type="number" value="5" ></td>
</tr>
<tr>
  <td>Finger Length</td>
  <td><input class="boxDim" id="fingerLength" type="number" value="10" ></td>
</tr>
<tr>
  <td>Finger Spacing</td>
  <td><input class="boxDim" id="fingerSpacing" type="number" value="10" ></td>
</tr>
<tr>
  <td>Toolbit Diam</td>
  <td><input class="boxDim" id="toolbitDiam" type="number" value="5" ></td>
</tr>

</table>

</div>

<div id="content" >
    <canvas id="mycanvas" width="300px" height="300px" ></canvas>
<!--     <canvas id="outcanvas" width="300px" height="300px" ></canvas> -->
    <canvas id="pathcanvas" width="300px" height="300px" ></canvas>
</div>


<div id="statusbar" >
&nbsp;&nbsp;Status Bar
</div>


</body>
</html>